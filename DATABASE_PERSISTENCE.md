# Сохранение базы данных между деплоями

## Проблема
При каждом деплое на DigitalOcean App Platform контейнер пересоздается, и база данных SQLite теряется, если она хранится во временной директории.

## Решение

### Вариант 1: Использовать переменную окружения DATABASE_URL (РЕКОМЕНДУЕТСЯ)

В DigitalOcean App Platform:

1. Откройте ваше приложение
2. Перейдите в **Settings** → **App-Level Environment Variables**
3. Добавьте переменную:
   ```
   DATABASE_URL=sqlite:////tmp/data/vacancies.db
   ```
   (Обратите внимание на 4 слеша: `sqlite:////tmp`)

4. Сохраните и перезапустите приложение

Директория `/tmp` в App Platform сохраняется между деплоями.

### Вариант 2: Использовать Managed Database (для продакшена)

Для надежного хранения данных рекомендуется использовать PostgreSQL:

1. В DigitalOcean создайте **Managed Database** (PostgreSQL)
2. Получите connection string
3. Установите переменную окружения:
   ```
   DATABASE_URL=postgresql://user:password@host:port/database
   ```
4. Обновите `requirements.txt` (если нужно):
   ```
   psycopg2-binary>=2.9.0
   ```

### Вариант 3: Использовать DigitalOcean Spaces (S3-совместимое хранилище)

Для очень больших баз данных можно использовать Spaces для хранения файла БД.

## Проверка

После настройки проверьте логи при запуске:
```
Database path: /tmp/data/vacancies.db
```

Если путь правильный, база данных будет сохраняться между деплоями.

## Важно

⚠️ **Регулярно делайте бэкапы базы данных!** Даже с постоянным хранилищем рекомендуется:
- Экспортировать данные через `/export`
- Делать резервные копии файла БД
- Использовать managed database для критичных данных
